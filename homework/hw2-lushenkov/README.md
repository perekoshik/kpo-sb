# HSE Finance Tracker

Консольный прототип модуля "Учёт финансов" для банка ВШЭ. Проект демонстрирует работу доменной модели, применение принципов SOLID, идей GRASP и нескольких паттернов GoF.

## Функциональность
- управление счетами (создание, переименование, пересчёт баланса);
- управление категориями доходов и расходов;
- операции (добавление, редактирование, удаление) с автоматическим пересчётом балансов счетов;
- аналитика: чистый результат за период, группировка по категориям, средний дневной расход;
- импорт данных из JSON/CSV/YAML и экспорт в те же форматы;
- измерение времени пользовательских сценариев (команда + декоратор);
- простое хранилище на JSON-файле с прокси-кэшем in-memory.

## Принципы SOLID и GRASP
- **Single Responsibility** - фасады разделены по областям (счета, категории, операции, аналитика, управление данными).
- **Open/Closed** - фабрика и репозиторий скрывают детали валидации и хранения, расширяются без изменения клиентского кода.
- **Liskov Substitution** - репозитории реализуют единый интерфейс, прокси подставляется вместо базовой реализации.
- **Interface Segregation** - фасады и команды предоставляют узкие интерфейсы под конкретные сценарии.
- **Dependency Inversion** - DI-контейнер `internal/utils/di.go` прокладывает зависимости от абстракций (интерфейс репозитория).
- **GRASP High Cohesion / Low Coupling** - бизнес-логика сосредоточена во фасадах;

## Использованные паттерны GoF
- **Factory Method** - `internal/domain/factory.DomainFactory` гарантирует создание валидных доменных объектов.
- **Facade** - `AccountFacade`, `CategoryFacade`, `OperationFacade`, `AnalyticsFacade`, `DataManagementFacade` упрощают работу с подсистемами.
- **Repository + Proxy** - `ProxyRepository` хранит кэш и делегирует запись `FileRepository`.
- **Command** — команды в `internal/services/command` инкапсулируют пользовательские сценарии.
- **Decorator** — `TimedCommand` измеряет время выполнения команд.
- **Template Method** — базовый `templateImporter` + конкретные импортёры (JSON/CSV/YAML).
- **Visitor** — `FileExportVisitor` обходит доменные сущности и формирует выгрузку.

## Структура проекта
```
cmd/app            - консольное приложение
internal/domain    - модели, фабрика, экспортный посетитель
internal/services  - фасады, репозитории, команды, импортёры, аналитика
internal/utils     - DI-контейнер
data               - JSON-файл хранилища (создаётся автоматически)
```

## Запуск 
```bash
GOCACHE=$(pwd)/.cache go run ./cmd/app
```

### Импорт/экспорт
- Экспорт: пункт меню 12, формат `json`, `yaml` или `csv`, путь по умолчанию `data/export.<fmt>`.
- Импорт: пункт меню 13, поддерживаются файлы, сформированные экспортом приложения.

## Тестирование и сборка
```bash
GOCACHE=$(pwd)/.cache go build ./cmd/... ./internal/...
```
> `go build ./...` может завершиться с ошибкой из-за незавершённых примеров в каталоге `patterns/`, оставленных из предыдущих экспериментов

